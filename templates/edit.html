{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <h2 class="mb-4">√âditer "{{ manga.titre }}"</h2>
        
        <div class="card shadow-sm">
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="titre" class="form-label">Titre</label>
                        <input type="text" 
                               class="form-control" 
                               id="titre" 
                               name="titre" 
                               value="{{ manga.titre }}" 
                               required>
                    </div>

                    <div class="mb-3">
                        <label for="chapitre" class="form-label">Dernier chapitre</label>
                        <input type="text" 
                               class="form-control" 
                               id="chapitre" 
                               name="chapitre" 
                               value="{{ manga.dernier_chapitre }}" 
                               required>
                    </div>

                    <div class="mb-3">
                        <label for="url" class="form-label">URL</label>
                        <input type="url" 
                               class="form-control" 
                               id="url" 
                               name="url" 
                               value="{{ manga.url }}" 
                               required>
                    </div>

                    <div class="mb-3">
                        <label for="resume" class="form-label">R√©sum√©</label>
                        <textarea class="form-control" 
                                  id="resume" 
                                  name="resume" 
                                  rows="4">{{ manga.resume or '' }}</textarea>
                    </div>

                    <!-- Image actuelle -->
                    <div class="mb-3">
                        <label class="form-label">Image de couverture actuelle</label>
                        <div class="border rounded p-2 text-center bg-light">
                            {% if manga.image_couverture %}
                                <img src="{{ manga.image_couverture }}" 
                                     alt="{{ manga.titre }}" 
                                     style="max-height: 300px; max-width: 100%;"
                                     onerror="this.src='https://via.placeholder.com/300x420?text=Erreur'">
                                <div class="form-check mt-2">
                                    <input class="form-check-input" 
                                           type="checkbox" 
                                           id="remove_image" 
                                           name="remove_image" 
                                           value="1">
                                    <label class="form-check-label text-danger" for="remove_image">
                                        üóëÔ∏è Supprimer cette image
                                    </label>
                                </div>
                            {% else %}
                                <p class="text-muted mb-0">Aucune image</p>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Upload nouvelle image -->
                    <div class="mb-3">
                        <label for="image_file" class="form-label">
                            üì∑ Remplacer par une nouvelle image
                        </label>
                        <input type="file" 
                               class="form-control" 
                               id="image_file" 
                               name="image_file" 
                               accept="image/png,image/jpeg,image/jpg,image/gif,image/webp">
                        <div class="form-text">
                            Formats accept√©s: PNG, JPG, GIF, WebP (max 16MB)
                        </div>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                            üíæ Enregistrer les modifications
                        </button>
                        <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                            Annuler
                        </a>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Informations suppl√©mentaires -->
        <div class="card mt-3">
            <div class="card-body">
                <h6 class="card-title">Informations</h6>
                <ul class="list-unstyled small mb-0">
                    <li><strong>Source :</strong> {{ manga.source or 'Inconnue' }}</li>
                    <li><strong>Ajout√© le :</strong> {{ manga.date_ajout.strftime('%d/%m/%Y √† %H:%M') }}</li>
                    <li><strong>Derni√®re modification :</strong> {{ manga.date_maj.strftime('%d/%m/%Y √† %H:%M') }}</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}